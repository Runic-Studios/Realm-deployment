apiVersion: v1
kind: ConfigMap
metadata:
  name: velocity-env-config
  namespace: {{ .Values.namespace }}
data:
{{- $env := .Values.config.env }}
{{- $envConfigPath := printf "config/env/%s/velocity/**" $env }}
{{- range $path, $content := .Files.Glob $envConfigPath }}
  {{- $key := $path | trimPrefix (printf "config/env/%s/velocity/" $env) | replace "/" "__" }}
  {{ $key }}: |-
{{ toString $content | indent 4 }}
{{- end }}

